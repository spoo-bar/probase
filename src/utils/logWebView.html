<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Logs</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script>
        var scrollEnabled = true;

        const vscode = acquireVsCodeApi();

        window.addEventListener('message', event => {
            const message = event.data;

            //Checking if element already exists and do nothing if it does
            var ele = document.getElementById(message.ID);
            if (typeof (ele) != undefined && ele != null)
                return;

            var logItemsDiv = document.getElementById('logItems');
            var logItem = document.createElement('div');
            logItem.id = message.ID;
            logItem.className += 'logItemDiv';

            var playIconLink = document.createElement('a');
            playIconLink.href = '#';
            playIconLink.addEventListener("click", function (evt) {
                postMessageToExtension('run-sql', evt.target.getAttribute('data-message'));
            });
            var playIcon = document.createElement('i');
            playIcon.className += 'icon fa fa-play';
            playIcon.setAttribute('data-message', message.Message);
            playIconLink.appendChild(playIcon);
            logItem.appendChild(playIconLink);

            var copyIconLink = document.createElement('a');
            copyIconLink.href = '#';
            copyIconLink.addEventListener("click", function (evt) {
                var temp = document.createElement('textarea');
                temp.value = evt.target.getAttribute('data-message') + '\\n\\n';
                document.body.appendChild(temp);
                temp.select();
                document.execCommand('copy');
                temp.remove();
            });
            var copyIcon = document.createElement('i');
            copyIcon.className += 'icon fa fa-clipboard';
            copyIcon.setAttribute('data-message', message.Message);
            copyIconLink.appendChild(copyIcon);
            logItem.appendChild(copyIconLink);

            var logMessage = document.createTextNode(message.Message);
            logItem.appendChild(logMessage);
            logItemsDiv.appendChild(logItem);

            if (scrollEnabled) { window.scrollTo(0, document.body.scrollHeight); }
        });

        function postMessageToExtension(messageType, messageContent) {
            var message = {
                command: messageType,
                content: messageContent
            };
            vscode.postMessage(message);
            return;
        }

    </script>
    <style>
        .logItemDiv {
            padding: 15px;
        }

        .icon {
            padding-right: 10px;
        }

        a i.icon {
            font-size: medium;
        }

        #log-view-actions {
            padding-top: 10px;
            max-height: 100%;
            margin-bottom: 20px;
            position: fixed;
            background-color: var(--vscode-editor-background);
            overflow: scroll;
            width: 100%;
        }

        body.vscode-light i.fa-play {
            color: green;
        }

        body.vscode-dark i.fa-play {
            color: lightgreen;
        }

        body.vscode-high-contrast i.fa-play {
            color: lawngreen;
        }

        body.vscode-light i.fa-clipboard {
            color: black;
        }

        body.vscode-dark i.fa-clipboard {
            color: white;
        }

        body.vscode-high-contrast i.fa-clipboard {
            color: red;
        }

        body.vscode-light i.fa-trash {
            color: red;
        }

        body.vscode-dark i.fa-trash {
            color: red;
        }

        body.vscode-high-contrast i.fa-trash {
            color: red;
        }

        body.vscode-light i.fa-pause-circle {
            color: black;
        }

        body.vscode-dark i.fa-pause-circle {
            color: white;
        }

        body.vscode-high-contrast i.fa-pause-circle {
            color: red;
        }

        body.vscode-light i.fa-play-circle {
            color: black;
        }

        body.vscode-dark i.fa-play-circle {
            color: white;
        }

        body.vscode-high-contrast i.fa-play-circle {
            color: red;
        }

        body.vscode-light i.fa-floppy-o {
            color: black;
        }

        body.vscode-dark i.fa-floppy-o {
            color: white;
        }

        body.vscode-high-contrast i.fa-floppy-o {
            color: red;
        }

        button {
            border: none;
            padding: 7px;
            outline: none;
            background: none;
            cursor: pointer;
        }

        body.vscode-light button {
            color: black;
        }

        body.vscode-dark button {
            color: white;
        }

        body.vscode-high-contrast button {
            color: white;
        }

        span {
            margin-right: 20px;
        }
    </style>
</head>

<body>
    <main>
        <div id="log-view-actions">
            <a id="log-pause-btn" title="Pause/Resume log"><i class="icon fa fa-pause-circle"></i><span>Pause Log</span></a> 
            <a id="clear-btn" title="Clear Log" onclick="console.log(2);"><i class="icon fa fa-trash"></i></a><span>Clear Log</span>
            <!-- <a id="save-btn" title="Save Log"><i class="icon fa fa-floppy-o"></i><span>Save Log</span></a> -->
        </div>
        <div id="logItems" style="padding-top: 22px;">
        </div>
    </main>
    <script>
        document.getElementById('log-pause-btn').onclick = function () {
            if (scrollEnabled) {
                scrollEnabled = false;
                document.getElementById('log-pause-btn').innerHTML = "<i class=\"icon fa fa-play-circle\"></i><span>Resume Log</span>";
            }
            else {
                scrollEnabled = true;
                document.getElementById('log-pause-btn').innerHTML = "<i class=\"icon fa fa-pause-circle\"></i><span>Pause Log</span>";
            }
        };
    </script>
</body>

</html>